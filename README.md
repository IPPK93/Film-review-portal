# Film review portal

## Описание

Проект состоит из нескольких частей:

- `app` - модуль с приложением;
				
		- `database` - модуль с инициализацией объектов для `sqlalchemy`;

		- `models` - модуль с моделями для `Base` объекта `sqlalchemy`;
		
		- `schemas` - модуль с классами `pydantic` для нашего `FastAPI`-приложения:

		- `crud` - модуль с имплементацией `CRUD`-функций (в данном случае только `CR`) для нашего приложения;

		- `fastapi_app` - модуль с реализацией `FastAPI`-приложения;
		
- `tests` - тесты.

Также содержатся файлы для менеджинга зависимостей (посредством `poetry`), `makefile` и `Dockerfile` для удобной работы с программой.



## Запуск

Для запуска в командной строке в директории с проектом нужно набрать

```
make up
```

Эта команда создаст `Docker` изображение и контейнер, после чего запустит программу. Для проверки работы приложения надо перейти в `localhost:8000/docs`. 

До авторизации пользователю доступна лишь возможность зарегистрироваться, остальные команды попросят войти в аккаунт. Все основные требования в задании касательно самого приложения реализованы (усложнённого варианта нет). Можно выводить не весь список элементов (если такой является результатом запроса), меняя параметры `skip` и `limit`, они выдают элементы в диапазоне `[skip; skip + limit)`. 

## Тесты

Для запуска тестов в `Docker` можно набрать

```
make docker-test
```

Либо можно поставить виртуальное окружение (`make venv`) и набрать 

```
make test
```

## Линтеры

Для запуска линтеров можно набрать 

```
make docker-lint
```

либо

```
make lint
```

## Корректность работы целиком

```
make docker-check
```

либо

```
make check
```

## Дополнительно 

В коде может встретиться следующий подозрительный код:

```
    num_review = (
        db.query(models.FilmReview)
        .filter(models.FilmReview.film_name == film_name)
        .filter(  # pylint: disable=singleton-comparison
            models.FilmReview.review != None  # noqa: E711
        )
    ).count()
```

Это сделано для того, чтобы линтеры не ругались на сравнение с `None` с помощью оператора неравенства (оператор `is not` не подойдёт для `sqlalchemy`).



Программа покрыта тестами на 95%, для тестирования использовался `pytest`. 
Прохождение всех линтеров и тестов c помощью (`make check`/`make docker-check`).
Все зависимости фиксировались через `poetry`.
В качестве базы данных использован `sqlite`, в качестве ORM - `sqlalchemy`.
Сервис запускается в докер-контейнере.

---
Спасибо за прочтение!
